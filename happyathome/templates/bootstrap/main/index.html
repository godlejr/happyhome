{% extends "bootstrap/base.html" %}

{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.cycle2/2.1.6/jquery.cycle2.min.js"></script>
<div class="cycle-slideshow img_section"
     data-cycle-fx="scrollHorz"
     data-cycle-center-horz="true"
     data-cycle-center-vert="true"
     data-cycle-speed="500">
    <img src="{{ url_for('static', filename='img/main/slide/01.jpg') }}" width="100%">
    <img src="{{ url_for('static', filename='img/main/slide/02.jpg') }}" width="100%">
    <img src="{{ url_for('static', filename='img/main/slide/03.jpg') }}" width="100%">
</div>

<div class="content">
    <div class="content-title">해피홈 추천 테마</div>
    <div class="cards magazines">
        {% for card in magazines %}
            {% if card.photos %}
            <div class="card" id="magazines-{{ card.id }}" style="background-image:url(http://static.inotone.co.kr/data/img/{{ card.photos[0].file.name }})">
                {% if card.vr_count  %}
                    <div class="card-media"><span class="vr-icon"></span></div>
                {% endif %}
                {% if card.mov_count  %}
                    <div class="card-media"><span class="mov-icon"></span></div>
                {% endif %}
                <div class="card-info">
                    <div class="card-author">
                        <a href="{{ url_for('users.info',id = card.user.id) }}"><div class="card-avatar" style="background-image:url({{ url_for_s3('S3_USER_DIRECTORY', filename=card.user.avatar) }}) "></div></a>
                        <a class="card-user" href="{{ url_for('users.info',id = card.user.id) }}">{{ card.user.name }}</a>
                        <div class="card-hits"><img src="{{ url_for('static', filename='img/main/view_i.png') }}" /> {{ card.hits }}</div>
                    </div>
                    <div class="card-content">
                        <div class="card-text">
                            <div class="card-category"><a href="{{ url_for('magazines.list', category_id=card.category_id) }}">{{ card.category.name }}</a></div>
                            <div class="card-title">{{ card.title }}</div>
                        </div>
                        <div class="card-icon">
                            <div class="icon"><img src="{{ url_for('static', filename='img/main/like_i.png') }}" /> {{ card.like_magazines|length }}</div>
                            <div class="icon"><img src="{{ url_for('static', filename='img/main/scrab_i.png') }}" /> {{ card.scrap_magazines|length }}</div>
                            <div class="icon"><img src="{{ url_for('static', filename='img/main/comment_i.png') }}" /> {{ card.comments|length }}</div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        {% endfor %}
    </div>

    <div class="content-title">해피홈 갤러리</div>
    <div class="cards photos">
        {% for card in photos %}
            <div class="card" id="photos-{{ card.id }}" style="background-image:url(http://static.inotone.co.kr/data/img/{{ card.file.name }})">
                {% if card.is_vr  %}
                    <div class="card-media"><span class="vr-icon"></span></div>
                {% elif card.is_mov  %}
                    <div class="card-media"><span class="mov-icon"></span></div>
                {% endif %}
                <div class="card-info gallery">
                    <div class="card-author">
                        <a href="{{ url_for('users.info',id = card.user.id) }}"><div class="card-avatar" style="background-image:url({{ url_for_s3('S3_USER_DIRECTORY', filename=card.user.avatar) }})"></div></a>
                        <a class="card-user" href="{{ url_for('users.info',id = card.user.id) }}">{{ card.user.name }}</a>
                        <div class="card-hits"><img src="{{ url_for('static', filename='img/main/view_i.png') }}" /> {{ card.hits }}</div>
                    </div>
                    <div class="card-content">
                        <div class="card-text">{{ card.content[:50] }}</div>
                        <div class="card-icon">
                            <div class="icon"><img src="{{ url_for('static', filename='img/main/like_i.png') }}" /> {{ card.like_photos|length }}</div>
                            <div class="icon"><img src="{{ url_for('static', filename='img/main/scrab_i.png') }}" /> {{ card.scrap_photos|length }}</div>
                            <div class="icon"><img src="{{ url_for('static', filename='img/main/comment_i.png') }}" /> {{ card.comments|length }}</div>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<script>
$('.card').click(function() {
    var $contents = $(this).attr('id').split('-');

    if ($contents[0] == 'magazines') {
        document.location.href = "{{ url_for('magazines.detail', id='') }}" + $contents[1];
    } else if ($contents[0] == 'photos') {
        document.location.href = "{{ url_for('photos.detail', id='') }}" + $contents[1];
    } else {
    }
});

$('.photos .card').hover(
    function() {
        $(this).find('.card-info').stop().animate({
            bottom: 0
        });
    },
    function() {
        $(this).find('.card-info').stop().animate({
            bottom: "-64px"
        });
    }
);
</script>
{% endblock %}
