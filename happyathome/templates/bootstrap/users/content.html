{% extends 'bootstrap/users/base.html' %}

{% block content%}
<div class="content">
    <div class="users-hp" id="{{ post.id }}"
         {% if post.cover %}
         style="background-image:url( {{ current_app.config['S3_BUCKET_NAME'] + current_app.config['S3_COVER_DIRECTORY'] + post.cover }} )"
         {% else %}
         style="background-image:url( {{ current_app.config['S3_BUCKET_NAME'] + current_app.config['S3_COVER_DIRECTORY'] + current_app.config['NO_IMG'] }} )"
         {% endif %}>
        <div class="users-hp-info">
            <div class="users-hp-avatar-info">
                <div class="users-hp-avatar" {% if post.avatar %}
                     style="background-image:url( {{ current_app.config['S3_BUCKET_NAME'] + current_app.config['S3_USER_DIRECTORY'] + post.avatar }} )"
                     {% else %}
                     style="background-image:url( {{ current_app.config['S3_BUCKET_NAME'] + current_app.config['S3_COVER_DIRECTORY'] + current_app.config['NO_IMG'] }} )"
                     {% endif %}>
                </div>
                <div class="users-hp-review">
                    review *****
                </div>
            </div>
            <div class="users-hp-company-info">
                <div class="users-hp-company-name">
                    {{ post.name }}
                </div>
                <div class="users-hp-company-follow">
                  <a href="{{url_for('users.follow',id=post.id)}}">{{ post.following_count(post.id) }} 팔로잉  {{ post.follower_count(post.id) }} 팔로워</a>
                </div>
            </div>
            {% if session.user_id %}
                {%if session.user_id == post.id %}
                <div class="users-hp-profile-edit">
                    <div class="users-hp-pofile-editbutton"><a href="{{ url_for('users.edit_info',id=post.id) }}">프로필 수정</a></div>
                </div>
                {% else %}

                    <div class="follow {% if post.follow_check(session.user_id ,post.id) %} display_none{% endif %}" >
                        <div class="users-hp-pofile-editbutton">팔로잉</div>
                    </div>
                    <div class="follow {% if not post.follow_check(session.user_id ,post.id) %} display_none{% endif %}" >
                        <div class="users-hp-pofile-editbutton">팔로잉 취소</div>
                    </div>

                {% endif %}
            {% endif %}
        </div>
    </div>

    <div class="users-hp-button-list">
        <ul class="users-hp-menu">
            {{ func.render_sub_hp_menu('users.gallery', '갤러리', post.id) }}
            {{ func.render_sub_hp_menu('users.story', '스토리', post.id) }}
            {{ func.render_sub_hp_menu('professionals.list', '스크랩') }}
            {{ func.render_sub_hp_menu('users.question', 'Q&A', post.id) }}
            {{ func.render_sub_hp_menu('professionals.list', '리뷰') }}
        </ul>
    </div>
   {% block content_body %}{% endblock %}
</div>

<script>
    $(".follow").click(function(){
        follow();
    });

    function follow(){
         $.ajax({
                type: "POST",
                url: "{{ url_for('users.following') }}",
                data: {
                    follow_id: "{{ post.id }}"
                }
            }).success(function(data) {
                $(".follow").children().remove();
                if(data.ok == 1){

                     $(".follow").append('<div class="users-hp-pofile-editbutton">팔로잉 취소</div>');
                }else{
                     $(".follow").append('<div class="users-hp-pofile-editbutton">팔로잉</div>');
                }

            });
    }



</script>
{% endblock %}