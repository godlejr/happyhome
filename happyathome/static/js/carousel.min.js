/*!
 * Copyright Inotone Co., ltd.
 */
var Carousel=function(){var b=function(){this.fov=75;this.savedLatitude=this.savedLongitude=this.latitude=this.longitude=this.savedY=this.savedX=0;this.autoFlow=!0;this.isUserInteracting=!1};b.prototype={viewer:function(a,c){var d=c.is_like||!1,e=c.is_scrap||!1,f=c.action||!1,g=document.createElement("span"),h=document.createElement("span"),b=document.createElement("span"),k=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div");g.classList.add("like-icon");
d&&g.classList.add("active");h.classList.add("scrap-icon");e&&h.classList.add("active");b.classList.add("share-icon");k.classList.add("content-like");k.appendChild(g);l.appendChild(h);l.classList.add("content-scrap");m.appendChild(b);m.classList.add("content-share");this.photoWrap=document.getElementById(a);this.photoWrap.style.position="relative";f&&(this.photoWrap.appendChild(k),this.photoWrap.appendChild(l),this.photoWrap.appendChild(m));this.canvasWidth=this.photoWrap.offsetWidth;this.canvasHeight=
this.photoWrap.offsetHeight;d=new THREE.SphereGeometry(500,60,40);d.applyMatrix((new THREE.Matrix4).makeScale(-1,1,1));e=new THREE.TextureLoader;e.crossOrigin="";f=new THREE.MeshBasicMaterial;f.map=e.load(c.panorama,function(a){},function(a){console.log(a.loaded/a.total*100+"% loaded")},function(a){console.log("An error happened")});this.scene=new THREE.Scene;this.scene.add(new THREE.Mesh(d,f));this.camera=new THREE.PerspectiveCamera(this.fov,this.canvasWidth/this.canvasHeight,1,1100);this.camera.target=
new THREE.Vector3(0,0,0);this.renderer=new THREE.WebGLRenderer;this.renderer.setSize(this.canvasWidth,this.canvasHeight);this.photoWrap.appendChild(this.renderer.domElement);this.photoWrap.addEventListener("mouseup",this.onPhotoMouseUp.bind(this),!1);this.photoWrap.addEventListener("mousedown",this.onPhotoMouseDown.bind(this),!1);this.photoWrap.addEventListener("mousemove",this.onPhotoMouseMove.bind(this),!1);this.photoWrap.addEventListener("mousewheel",this.onPhotoMouseWheel.bind(this),!1);this.animate()},
onPhotoMouseUp:function(a){this.isUserInteracting=!1},onPhotoMouseDown:function(a){a.preventDefault();this.autoFlow=!1;this.isUserInteracting=!0;this.savedX=a.clientX;this.savedY=a.clientY;this.savedLongitude=this.longitude;this.savedLatitude=this.latitude},onPhotoMouseMove:function(a){this.isUserInteracting&&(this.longitude=.1*(this.savedX-a.clientX)+this.savedLongitude,this.latitude=.1*(a.clientY-this.savedY)+this.savedLatitude)},onPhotoMouseWheel:function(a){a.preventDefault();a.wheelDeltaY?this.fov-=
.05*a.wheelDeltaY:a.wheelDelta?this.fov-=.05*a.wheelDelta:a.detail&&(this.fov+=1*a.detail);35>this.fov?this.fov=35:95<this.fov&&(this.fov=95);this.camera.projectionMatrix.makePerspective(this.fov,this.canvasWidth/this.canvasHeight,1,1100);this.render()},animate:function(){this.render();window.requestAnimationFrame(this.animate.bind(this))},render:function(){this.autoFlow&&(this.longitude+=.1);this.latitude=Math.max(-85,Math.min(85,this.latitude));this.camera.target.x=500*Math.sin(THREE.Math.degToRad(90-
this.latitude))*Math.cos(THREE.Math.degToRad(this.longitude));this.camera.target.y=500*Math.cos(THREE.Math.degToRad(90-this.latitude));this.camera.target.z=500*Math.sin(THREE.Math.degToRad(90-this.latitude))*Math.sin(THREE.Math.degToRad(this.longitude));this.camera.lookAt(this.camera.target);this.renderer.render(this.scene,this.camera)}};return b}();
